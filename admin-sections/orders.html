<div class="products-container">
    <h2>üì¶ –ü–æ—Ä—ä—á–∫–∏</h2>

    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞ –ø–æ–¥—Ä–∞–≤–Ω—è–≤–∞–Ω–µ –Ω–∞ –±—É—Ç–æ–Ω–∞ 
    <div class="products-header">
        <button id="add-product-btn" class="btn-add-product">‚ûï –î–æ–±–∞–≤–∏ –Ω–æ–≤ –ø—Ä–æ–¥—É–∫—Ç</button>
    </div>-->

    <table class="products-table">
       <!-- <table id="orders-table">-->
        <thead>
           <tr>
              <th>–ò–º–µ</th>
              <th>–ò–º–µ–π–ª</th>
              <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
              <th>–ê–¥—Ä–µ—Å</th>
              <th>–ü–ª–∞—â–∞–Ω–µ</th>
              <th>–°—Ç–∞—Ç—É—Å</th>
              <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
              <th>–î–∞—Ç–∞</th>
              <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
        </thead>
        <tbody id="products-table-body">
            <!-- –ü—Ä–æ–¥—É–∫—Ç–∏—Ç–µ —â–µ —Å–µ –∑–∞—Ä–µ–∂–¥–∞—Ç –¥–∏–Ω–∞–º–∏—á–Ω–æ -->
        </tbody>
    </table>

    <p id="no-products">üîÑ –ó–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏...</p>
</div>

<!-- ‚úÖ –í—ä–Ω—à–Ω–∏—è—Ç CSS –∑–∞ —Å—Ç–∏–ª–æ–≤–µ -->
<link rel="stylesheet" href="styles/products.css">

<!-- ‚úÖ –ó–∞—Ä–µ–∂–¥–∞–º–µ `products.js` -->
<script src="scripts/products.js" defer></script>


<!-- ‚úÖ CSS –∫–æ—Ä–µ–∫—Ü–∏–∏ -->
<style>

        .product-thumbnail {
        width: 60px;
        height: auto;
        border-radius: 6px;
        transition: transform 0.2s;
    }
    
    .product-thumbnail:hover {
        transform: scale(1.15);
    }

    .products-header {
        display: flex;
        justify-content: flex-start; /* –ë—É—Ç–æ–Ω—ä—Ç –æ—Å—Ç–∞–≤–∞ –≤ –ª—è–≤–æ */
        margin-bottom: 10px;
    }

    .btn-add-product {
        background: #ffcc99;
        color: #121212;
        padding: 10px 15px;
        border: none;
        cursor: pointer;
        transition: 0.3s;
        border-radius: 5px;
        font-size: 16px;
        font-weight: bold;
        box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3);
    }

    .btn-add-product:hover {
        background: #f5b977;
    }

    /* ‚úÖ –°—Ç–∏–ª–∏–∑–∏—Ä–∞–Ω–µ –Ω–∞ —Ç–∞–±–ª–∏—Ü–∞—Ç–∞ */
    .products-table {
        width: 100%;
        border-collapse: collapse;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        overflow: hidden;
    }

    .products-table th, .products-table td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    }

    .products-table th {
        background: rgba(0, 0, 0, 0.6);
        color: #ffcc99;
    }

    .products-table tbody tr {
        transition: background 0.3s;
    }

    .products-table tbody tr:hover {
        background: rgba(255, 204, 153, 0.3);
        cursor: pointer;
    }

    .products-table tbody tr.selected {
        background: rgba(255, 153, 102, 0.5);
    }

    /* ‚úÖ –ë—É—Ç–æ–Ω–∏—Ç–µ –∑–∞ –¥–µ–π—Å—Ç–≤–∏—è –ø—ä—Ä–≤–æ–Ω–∞—á–∞–ª–Ω–æ —Å–∫—Ä–∏—Ç–∏ */
    .actions {
        display: none;
    }

    /* ‚úÖ –ü–æ–∫–∞–∑–≤–∞–º–µ –±—É—Ç–æ–Ω–∏—Ç–µ —Å–∞–º–æ –∑–∞ –∏–∑–±—Ä–∞–Ω–∏—è —Ä–µ–¥ */
    .product-row.selected .actions {
        display: flex;
        gap: 10px;
    }
</style>

<!-- ‚úÖ –°–∫—Ä–∏–ø—Ç –∑–∞ –¥–∏–Ω–∞–º–∏—á–Ω–æ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ -->
<script>
document.addEventListener("DOMContentLoaded", function() {
    console.log("üöÄ –ó–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏...");
    const productList = document.getElementById("products-table-body");
    const addProductBtn = document.getElementById("add-product-btn");

    function loadProducts() {
        fetch("https://api.dp-design.art/products")
            .then(response => response.json())
            .then(data => {
                productList.innerHTML = "";
                if (data.length === 0) {
                    document.getElementById("no-products").textContent = "–ù—è–º–∞ –Ω–∞–ª–∏—á–Ω–∏ –ø—Ä–æ–¥—É–∫—Ç–∏.";
                    return;
                }

                data.forEach(product => {
                    const row = document.createElement("tr");
                    row.classList.add("product-row");
                    row.innerHTML = `
                        <td>${product.id}</td>
                        <td><img src="${product.images[0]}" alt="–ü—Ä–æ–¥—É–∫—Ç–æ–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" class="product-thumbnail"></td>
                        <td>${product.name}</td>
                        <td>${product.category || "–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏—è"}</td>
                        <td>${product.price} –ª–≤.</td>
                        <td>${product.promo_price ? product.promo_price + " –ª–≤." : "‚Äî"}</td>
                        <td class="actions">
                            <button class="edit-btn">‚úèÔ∏è</button>
                            <button class="delete-btn">üóëÔ∏è</button>
                        </td>
                    `;

                    // ‚úÖ –ú–∞—Ä–∫–∏—Ä–∞–Ω–µ –Ω–∞ –∏–∑–±—Ä–∞–Ω–∏—è —Ä–µ–¥ –∏ –ø–æ–∫–∞–∑–≤–∞–Ω–µ –Ω–∞ –±—É—Ç–æ–Ω–∏—Ç–µ
                    row.addEventListener("click", function() {
                        document.querySelectorAll(".product-row").forEach(tr => tr.classList.remove("selected"));
                        row.classList.add("selected");
                    });

                    // ‚úÖ –ë—É—Ç–æ–Ω "–†–µ–¥–∞–∫—Ç–∏—Ä–∞–Ω–µ"
                    row.querySelector(".edit-btn").addEventListener("click", function(event) {
                        event.stopPropagation();
                        window.location.href = `edit-product.html?id=${product.id}`;
                    });

                    // ‚úÖ –ë—É—Ç–æ–Ω "–ò–∑—Ç—Ä–∏–≤–∞–Ω–µ"
                    row.querySelector(".delete-btn").addEventListener("click", function(event) {
                        event.stopPropagation();
                        if (confirm(`‚ö†Ô∏è –°–∏–≥—É—Ä–Ω–∏ –ª–∏ —Å—Ç–µ, —á–µ –∏—Å–∫–∞—Ç–µ –¥–∞ –∏–∑—Ç—Ä–∏–µ—Ç–µ "${product.name}"?`)) {
                            deleteProduct(product.id);
                        }
                    });

                    productList.appendChild(row);
                });
            })
            .catch(error => console.error("‚ùå –ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏:", error));
    }

    // ‚úÖ –ò–∑—Ç—Ä–∏–≤–∞–Ω–µ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç
    function deleteProduct(productId) {
        fetch(`https://api.dp-design.art/products/${productId}`, { method: "DELETE" })
            .then(response => {
                if (response.ok) {
                    alert("‚úÖ –ü—Ä–æ–¥—É–∫—Ç—ä—Ç –±–µ—à–µ –∏–∑—Ç—Ä–∏—Ç!");
                    loadProducts();
                } else {
                    alert("‚ùå –ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∏–∑—Ç—Ä–∏–≤–∞–Ω–µ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∞!");
                }
            })
            .catch(error => console.error("‚ùå –ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∏–∑—Ç—Ä–∏–≤–∞–Ω–µ:", error));
    }

    // ‚úÖ –ü—Ä–µ–Ω–∞—Å–æ—á–≤–∞–Ω–µ –∫—ä–º add-product.html
    addProductBtn.addEventListener("click", function() {
        window.location.href = "https://dp-design.art/add-product.html";
    });

    // ‚úÖ –ó–∞—Ä–µ–∂–¥–∞–º–µ –ø—Ä–æ–¥—É–∫—Ç–∏—Ç–µ
    loadProducts();
});
</script>
