<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Персонализирани продукти | DP Design</title>
    
    <style>
        body { background-color: #121212; color: #fce5cd; font-family: Arial, sans-serif; }
        .products-wrapper { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; }
        .product { background: rgba(255, 255, 255, 0.1); border-radius: 10px; padding: 15px; }
        .promo-badge { position: absolute; top: 8px; left: 8px; background-color: #e60000; color: #fff; padding: 3px 8px; border-radius: 5px; font-size: 14px; font-weight: bold; }
        .slider img { width: 100%; display: none; }
        .slider img.active { display: block; }
        .button-see-more, .button-buy { background-color: #fce5cd; color: #000; padding: 10px; margin-top: 10px; border-radius: 5px; text-decoration: none; }
        .price-container p del { color: red; }
        .price-container p:last-child { font-weight: bold; font-size: 130%; }
    </style>
</head>
<body>
    <div id="header"></div>

    <div class="products-wrapper" id="product-list"></div>

    <div id="footer"></div>

    <script>
    async function loadProducts() {
        const response = await fetch('https://script.google.com/macros/s/YOUR_DEPLOYMENT_URL/exec');
        const products = await response.json();
        const container = document.getElementById('product-list');
        
        products.forEach(product => {
            const images = product.imageUrls.map((url, i) => `<img src="${url}" class="${i === 0 ? 'active' : ''}" alt="${product.name}">`).join('');
            const promoBadge = product.promoPrice ? '<span class="promo-badge">Промо</span>' : '';
            const priceHTML = product.promoPrice ? `<p><del>${product.price} лв.</del></p><p>${product.promoPrice} лв.</p>` : `<p>${product.price} лв.</p>`;
            
            container.innerHTML += `
                <div class="product">
                    <div class="slider">
                        ${promoBadge}
                        ${images}
                        <button class="slider-btn left" onclick="prevSlide(this)">◀</button>
                        <button class="slider-btn right" onclick="nextSlide(this)">▶</button>
                    </div>
                    <h2>${product.name}</h2>
                    <div class="price-container">${priceHTML}</div>
                    <a href="#" class="button-buy">Купи сега!</a>
                    <a href="product-template.html?slug=${product.slug}" class="button-see-more">Виж още</a>
                </div>
            `;
        });
    }

    function prevSlide(button) {
        const slider = button.parentElement;
        const images = slider.querySelectorAll('img');
        let index = Array.from(images).findIndex(img => img.classList.contains('active'));
        images[index].classList.remove('active');
        images[(index - 1 + images.length) % images.length].classList.add('active');
    }

    function nextSlide(button) {
        const slider = button.parentElement;
        const images = slider.querySelectorAll('img');
        let index = Array.from(images).findIndex(img => img.classList.contains('active'));
        images[index].classList.remove('active');
        images[(index + 1) % images.length].classList.add('active');
    }

    loadProducts();
    </script>
</body>
</html>
