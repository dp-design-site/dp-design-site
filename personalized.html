<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Персонализирани продукти | DP Design</title>
    
    <style>
        body { background-color: #121212; color: #fce5cd; font-family: Arial, sans-serif; }
        .products-wrapper { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; }
        .product { background: rgba(255, 255, 255, 0.1); border-radius: 10px; padding: 15px; position: relative; }
        .promo-badge { position: absolute; top: 8px; left: 8px; background-color: #e60000; color: #fff; padding: 3px 8px; border-radius: 5px; font-size: 14px; font-weight: bold; }
        .slider img { width: 100%; display: none; }
        .slider img.active { display: block; }
    </style>
</head>
<body>
    <div id="header"></div>
    <div class="products-wrapper" id="product-list">
        <p style="color:red; font-size:18px;">Зареждане на продуктите...</p>
    </div>
    <div id="footer"></div>

    <script>
    async function loadProducts() {
        const url = 'https://script.googleusercontent.com/macros/echo?user_content_key=YOUR_USER_CONTENT_KEY';
        try {
            const response = await fetch(url, { headers: { 'Accept': 'application/json' } });
            if (!response.ok) throw new Error(`HTTP грешка: ${response.status}`);
            const products = await response.json();

            if (!Array.isArray(products)) throw new Error('Получен е невалиден JSON формат');

            document.getElementById('product-list').innerHTML = products.map(({ name, price, promoPrice, slug }) => `
                <div class="product">
                    ${promoPrice ? '<span class="promo-badge">Промо</span>' : ''}
                    <h2>${name}</h2>
                    <p>${promoPrice ? `<del>${price} лв.</del> ${promoPrice} лв.` : `${price} лв.`}</p>
                    <a href="product-template.html?slug=${slug}" class="button-see-more">Виж още</a>
                </div>
            `).join('');
        } catch (error) {
            console.error('Грешка:', error.message);
            document.getElementById('product-list').innerHTML = '<p style="color:red;">Неуспешно зареждане на продуктите. Проверете CORS настройките и JSON формата.</p>';
        }
    }
    loadProducts();
    </script>
</body>
</html>
